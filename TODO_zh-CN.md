# 项目 TravelGPT: 待办事项与未来路线图

**[English](./TODO.md) | [简体中文](./TODO_zh-CN.md)**

本文档概述了将 TravelGPT 项目从当前状态推进到正式发布所需的剩余任务。本文档可作为开发工作重新开始时的核对清单。

---

## 第一阶段: 云基础设施迁移 (部署的最高优先级)

当前设置使用了仅限本地的数据库（SQLite 和本地向量存储），在生产环境中必须将它们迁移到云服务。

-   [ ] **将关系型数据库迁移到 PostgreSQL:**
    -   [ ] 选择一个云服务提供商（对于 Vercel 部署，推荐使用 Vercel Postgres；Supabase 或 Neon 也是很好的选择）。
    -   [ ] 创建一个新的 PostgreSQL 数据库实例，并获取其连接字符串 (`DATABASE_URL`)。
    -   [ ] 将 `DATABASE_URL` 添加到 `.env` 文件和 Vercel 的环境变量中。
    -   [ ] `prisma/schema.prisma` 文件已经被配置为使用 `postgresql`。
    -   [ ] 运行 `npx prisma db push` 将数据模型同步到新的云数据库中。

-   [ ] **将向量数据库迁移到云服务:**
    -   [ ] 当前的 `vectorDBService.ts` 可能正在使用本地或内存中的解决方案，需要将其替换为生产环境可用的方案。
    -   [ ] 选择一个托管的向量数据库提供商（例如 Pinecone, Zilliz Cloud, 或使用 pgvector 的 Supabase）。
    -   [ ] 创建一个新的向量数据库/索引，并获取所需的 API 密钥和环境 URL。
    -   [ ] 更新 `src/server/services/vectorDBService.ts` 和 `embeddingService.ts` 以连接到云提供商。
    -   [ ] 将必要的 API 密钥（例如 `PINECONE_API_KEY`）添加到 `.env` 和 Vercel 的环境变量中。

---

## 第二阶段: RAG 知识库的数据管道建设

RAG 系统的效果取决于其知识库的质量和新鲜度。

-   [ ] **完成数据爬虫脚本:**
    -   [ ] 审查并测试 `scraper.ts`，确保它能可靠地收集高质量数据。
    -   [ ] 实现健壮的错误处理机制，并考虑加入避免重复爬取相同内容的逻辑。

-   [ ] **创建并运行生产环境数据填充脚本:**
    -   [ ] 创建一个一次性的脚本（例如 `scripts/seed-vector-db.ts`），该脚本执行以下操作：
        1.  读取已收集的原始数据。
        2.  使用 `embeddingService` 生成向量。
        3.  使用生产环境的 `vectorDBService` 将这些向量上传并索引到云向量数据库中。
    -   [ ] 在项目正式上线前，必须运行一次此脚本以填充生产环境的知识库。

---

## 第三阶段: 前端功能开发

后端已具备一些高级功能，但尚未在前端界面中提供。

-   [ ] **构建对话式助手用户界面:**
    -   [ ] `chatWithPlanAssistant` tRPC 接口已功能完备，但缺少对应的用户界面。
    -   [ ] 在计划详情页 (`/my-plans/[planId]`) 上，添加一个新的聊天界面组件。
    -   [ ] 该界面应包括：
        -   一个消息展示区域，用于显示对话历史（从 `getConversationHistory` 获取）。
        -   一个文本输入框，供用户输入新消息。
        -   一个"发送"按钮，用于触发 `chatWithPlanAssistant` 变更。
        -   加载状态提示，以表明助手正在"思考"。
        -   在发送和接收新消息时，实时更新对话历史。

---

## 第四阶段: 生产环境准备与优化

确保应用健壮、安全且高性能的最后步骤。

-   [ ] **实现全面的日志记录与错误监控:**
    -   [ ] 集成一个日志服务（例如 Logtail, Sentry），以捕获后端错误和重要事件，特别是来自 AI 服务的事件。

-   [ ] **安全加固:**
    -   [ ] 审查所有数据库查询和用户输入，以发现潜在的安全漏洞。
    -   [ ] 考虑为计算密集型的 AI 接口（`analyzePlan`, `chatWithPlanAssistant`）添加速率限制，以防止滥用。

-   [ ] **性能优化:**
    -   [ ] 优化图片的加载和渲染。
    -   [ ] 审查组件的渲染逻辑，以最小化不必要的重新渲染。

-   [ ] **在 Vercel 上进行最终部署:**
    -   [ ] 仔细检查 Vercel 项目仪表盘中是否已设置所有生产环境变量。
    -   [ ] 从 `main` 分支触发最终的生产环境部署。
    -   [ ] 在正式的线上 URL 上全面测试所有应用功能。 